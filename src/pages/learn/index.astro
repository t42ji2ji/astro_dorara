---
import { themeConfig } from '~/.config'
import SiteSeo from '~/components/SiteSeo.astro'
import Analytics from '~/components/Analytics.astro'
import ThemeScript from '~/components/ThemeScript.astro'
import ThemeToggle from '~/components/ThemeToggle.astro'
import { getCourses } from '~/utils/learn'
import '~/styles/global.css'

const courses = await getCourses()
const lang = themeConfig.appearance.locale ?? 'en-us'
const dark = themeConfig.appearance.theme === 'dark'
---

<html lang={lang} class:list={[{ dark }]}>
  <head>
    <SiteSeo title={`Learn | ${themeConfig.site.title}`} desc="教學課程" />
    <Analytics />
    <ThemeScript />
  </head>

  <body class="min-h-screen bg-background text-primary">
    <header class="fixed top-0 left-0 right-0 z-50 bg-background border-b border-stone-200 dark:border-stone-700">
      <div class="max-w-4xl mx-auto flex items-center justify-between px-6 h-14">
        <a href="/" class="text-sm font-medium hover:text-stone-600 dark:hover:text-stone-400 transition-colors">
          ← {themeConfig.site.title}
        </a>
        <ThemeToggle />
      </div>
    </header>

    <main class="pt-14">
      <div class="max-w-4xl mx-auto px-6 py-12">
        <h1 class="text-2xl font-semibold text-stone-900 dark:text-stone-100 mb-2">Learn</h1>
        <p class="text-stone-600 dark:text-stone-400 mb-8">選擇一個課程開始學習</p>

        <div class="grid gap-4 sm:grid-cols-2">
          {
            courses.map((course) => (
              <a
                href={`/learn/${course.slug}`}
                class="
              not-prose not-underline-hover
              group block p-6 border border-stone-200 dark:border-stone-700 rounded-lg hover:border-stone-400 dark:hover:border-stone-500 transition-colors"
              >
                <h2 class="text-lg font-medium text-stone-900 dark:text-stone-100 group-hover:text-stone-700 dark:group-hover:text-stone-300 transition-colors mb-2">
                  {course.meta.title}
                </h2>
                {course.meta.description && (
                  <p class="text-sm text-stone-600 dark:text-stone-400">{course.meta.description}</p>
                )}
              </a>
            ))
          }
        </div>

        {courses.length === 0 && <p class="text-stone-500 dark:text-stone-500">目前沒有課程</p>}
      </div>
    </main>
  </body>
</html>
