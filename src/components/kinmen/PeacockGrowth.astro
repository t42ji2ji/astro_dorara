---
import InteractiveContainer from '../InteractiveContainer.astro'

interface DataPoint {
  year: number
  count: number
  event?: string
}

const data: DataPoint[] = [
  { year: 1999, count: 14, event: 'ä¸¹æ©é¢±é¢¨ï¼Œ14éš»é€ƒè„«' },
  { year: 2003, count: 50 },
  { year: 2007, count: 150 },
  { year: 2011, count: 400 },
  { year: 2015, count: 800 },
  { year: 2019, count: 1200, event: 'æ”¿åºœé–‹å§‹æ‡¸è³æ•æ‰' },
  { year: 2023, count: 2000, event: 'é¤å»³æ¨å‡ºå­”é›€æ–™ç†' },
  { year: 2024, count: 2400, event: 'ç¹æ®–ä»å¤±æ§ä¸­' }
]

const maxCount = Math.max(...data.map(d => d.count))
---

<InteractiveContainer
  title="å­”é›€å…¥ä¾µé‡‘é–€"
  description="å¾14éš»åˆ°2400éš»ï¼Œä¸€å ´å¤±æ§çš„ç”Ÿæ…‹å±æ©Ÿ"
>
  <div class="space-y-6">
    <!-- Horizontal Bar Chart -->
    <div class="space-y-3">
      {data.map((point, index) => {
        const width = (point.count / maxCount) * 100
        return (
          <div
            class="bar-row flex items-center gap-3 cursor-pointer group"
            data-index={index}
            data-count={point.count}
            data-year={point.year}
            data-event={point.event || ''}
          >
            <!-- Year -->
            <div class="w-12 text-right text-sm font-mono text-stone-500 dark:text-stone-400 shrink-0">
              {point.year}
            </div>

            <!-- Bar container -->
            <div class="flex-1 h-8 bg-stone-100 dark:bg-stone-800 rounded-full overflow-hidden relative">
              <!-- Bar -->
              <div
                class="bar h-full rounded-full transition-all duration-500 flex items-center justify-end pr-3"
                style={`width: ${width}%; background: linear-gradient(to right, #059669, #10b981);`}
              >
                {point.count >= 100 && (
                  <span class="text-white text-xs font-bold whitespace-nowrap">
                    {point.count.toLocaleString()}
                  </span>
                )}
              </div>

              <!-- Count for small bars -->
              {point.count < 100 && (
                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-xs font-bold text-stone-600 dark:text-stone-300">
                  {point.count}
                </span>
              )}
            </div>

            <!-- Event badge -->
            <div class="w-32 md:w-40 shrink-0">
              {point.event ? (
                <span class="text-xs px-2 py-1 bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300 rounded-full whitespace-nowrap">
                  {point.event}
                </span>
              ) : (
                <span class="text-xs text-stone-400">â€”</span>
              )}
            </div>
          </div>
        )
      })}
    </div>

    <!-- Fun Facts -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mt-6">
      <div class="fact-card p-4 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-100 dark:border-red-800">
        <div class="text-2xl mb-1">ğŸ’°</div>
        <div class="font-bold text-stone-800 dark:text-stone-200">$600/éš»</div>
        <div class="text-xs text-stone-500 dark:text-stone-400">æ”¿åºœæ‡¸è³çå‹µ</div>
      </div>

      <div class="fact-card p-4 bg-amber-50 dark:bg-amber-900/20 rounded-lg border border-amber-100 dark:border-amber-800">
        <div class="text-2xl mb-1">ğŸ½ï¸</div>
        <div class="font-bold text-stone-800 dark:text-stone-200">æ³•å¼æ–™ç†</div>
        <div class="text-xs text-stone-500 dark:text-stone-400">é«˜ç´šé¤å»³æ–°èœè‰²</div>
      </div>

      <div class="fact-card p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-100 dark:border-purple-800">
        <div class="text-2xl mb-1">ğŸ“ˆ</div>
        <div class="font-bold text-stone-800 dark:text-stone-200">171å€</div>
        <div class="text-xs text-stone-500 dark:text-stone-400">25å¹´æˆé•·å¹…åº¦</div>
      </div>
    </div>
  </div>
</InteractiveContainer>


<style>
  .bar-row {
    transition: transform 0.2s ease;
  }

  .bar-row:hover {
    transform: scale(1.02);
  }

  .bar-row:hover .bar {
    filter: brightness(1.1);
  }

  .fact-card {
    transition: transform 0.2s ease;
  }

  .fact-card:hover {
    transform: translateY(-2px);
  }
</style>
